<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\Country;
use App\Models\City;
use App\Models\Region;

class CitiesBahrainSaudiSeeder extends Seeder
{
    public function run(): void
    {
        // Bahrain
        $bh = Country::whereHas('translations', function($q){ $q->where('name','البحرين'); })->first();
        if (!$bh) {
            $bh = Country::create(['is_active' => true]);
            if (method_exists($bh, 'translateOrNew')) {
                $bh->translateOrNew('ar')->name = 'البحرين';
                $bh->translateOrNew('en')->name = 'Bahrain';
                $bh->save();
            }
        } else {
            $bh->is_active = true; $bh->save();
        }

        $bahrain = [
            'العاصمة' => ['المنامة','جد علي','رأس رمان','أجزاء من جدحفص'],
            'المحرق' => ['المحرق','الحد','الدير','العراد','سترة','البسيتين','سمهيج','الغالي','أمواج'],
            'الشمالية' => ['عالي','أبو صيبع','المرخ','بديع','الحمّاد','الدراز','دار كليب','جبلة حبشي','المليكية','سار','سلماباد','قرى أخرى'],
            'الجنوبية' => ['الرفاع (الشرقي + الغربي)','مدينة عيسى','الزلاق','الهاجورة','عسكر','جو','مناطق جنوبية أخرى'],
        ];

        foreach ($bahrain as $gov => $cities) {
            foreach ($cities as $cname) {
                $city = new City();
                $city->country_id = $bh->id;
                $city->is_active = true;
                $city->save();
                $city->translateOrNew('ar')->name = $cname;
                $city->translateOrNew('en')->name = $cname;
                $city->save();
            }
        }

        // Saudi Arabia
        $sa = Country::whereHas('translations', function($q){ $q->where('name','المملكة العربية السعودية'); })->first();
        if (!$sa) {
            $sa = Country::create(['is_active' => true]);
            if (method_exists($sa, 'translateOrNew')) {
                $sa->translateOrNew('ar')->name = 'المملكة العربية السعودية';
                $sa->translateOrNew('en')->name = 'Saudi Arabia';
                $sa->save();
            }
        } else {
            $sa->is_active = true; $sa->save();
        }

        $saData = [
            'الرياض' => ['الرياض','الخرج','الدرعية','الدوادمي','المجمعة','القويعية','الأفلاج','وادي الدواسر','الزلفي','شقراء','حوطة بني تميم','عفيف','الغاط','السليل','ضرماء','المزاحمية','رماح','مرات','ثادق','حريملاء','الحريق'],
            'مكة المكرمة' => ['مكة المكرمة','جدة','الطائف','القنفذة','الليث','رابغ','خليص','الجموم','الكامل','الخرمة','رنية','تربة','المويه','ميسان','أضم','العرضيات'],
            'الشرقية' => ['الدمام','الخبر','الظهران','القطيف','الجبيل','الأحساء','حفر الباطن','الخفجي','رأس تنورة','بقيق','النعيرية','قرية العليا'],
            'المدينة' => ['المدينة المنورة','ينبع','العلا','المهد','الحناكية','بدر','خيبر','العيص','وادي الفرع'],
            'القصيم' => ['بريدة','عنيزة','الرس','المذنب','البكيرية','البدائع','الأسياح','النبهانية','الشماسية','عيون الجواء','رياض الخبراء','عقلة الصقور','ضرية'],
            'عسير' => ['أبها','خميس مشيط','بيشة','النماص','محايل','ظهران الجنوب','تثليث','سراة عبيدة','رجال ألمع','بلقرن','أحد رفيدة','المجاردة','البرك','بارق','تنومة','طريب'],
            'حائل' => ['حائل','بقعاء','الغزالة','الشنان','الحائط','السليمي','الشملي','موقق','سميراء'],
            'تبوك' => ['تبوك','الوجه','ضباء','تيماء','أملج','حقل','البدع'],
            'الباحة' => ['الباحة','بلجرشي','المندق','المخواة','قلوة','العقيق','القرى','غامد الزناد','الحجرة','بني حسن'],
            'الحدود الشمالية' => ['عرعر','رفحاء','طريف','العويقيلة'],
            'الجوف' => ['سكاكا','القريات','دومة الجندل','طبرجل'],
            'جازان' => ['جازان','صبيا','أبو عريش','صامطة','بيش','الدرب','الريث','الحرث','ضمد','فرسان','أحد المسارحة','العيدابي','العارضة','فيفا','الطوال','هروب'],
            'نجران' => ['نجران','شرورة','حبونا','بدر الجنوب','يدمة','ثار','خباش'],
            'تبوك (مشروع خاص)' => ['نيوم - مشروع خاص (يشمل الوجه، البدع، ضباء، حقل، تيماء جزئياً)'],
        ];

        foreach ($saData as $regionName => $cities) {
            foreach ($cities as $cname) {
                $city = new City();
                $city->country_id = $sa->id;
                $city->is_active = true;
                $city->save();
                $city->translateOrNew('ar')->name = $cname;
                $city->translateOrNew('en')->name = $cname;
                $city->save();
            }
        }
    }
}

